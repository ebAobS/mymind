# Changelog

## [1.0.1] (2025-10-06)

### 🐛 Bug Fixes

- 修复卸载逻辑缺失导致的内存泄漏问题
  - 添加 MutationObserver 的正确清理逻辑
  - 完善 `onunload()` 方法，确保所有资源正确释放
  - 删除空的 `uninstall()` 方法
- 修复打包脚本多包一层文件夹的问题
  - 优化 `package.py` 脚本，直接压缩 dist 内容
  - 修复 `scriptutils.py` 中的跨平台路径处理问题

---

## [1.0.0] (2025-10-06)

### 🎉 首个正式版本发布

这是 MyMind - 多维思维导图插件的首个正式版本，提供全方位的文档可视化解决方案。

### ✨ 核心功能

#### 🌳 文档树思维导图
- **功能**：以思维导图形式展示整个思源工作空间的文档目录结构
- **快捷键**：`Alt+Q`
- **层级结构**：
  - 根节点：工作空间名称
  - 一级节点：笔记本名称
  - 二级及以下：文档及其子文档
- **特性**：
  - 收集工作空间所有打开的笔记本
  - 递归展示完整的文档层级关系
  - 可配置默认展开层级（0 = 全部展开，≥1 = 展开指定层数）
  - 支持节点点击跳转到对应文档

#### 📄 文档思维导图
- **功能**：将当前打开的文档内容以思维导图形式展示
- **快捷键**：`Alt+W`
- **解析规则**：
  - 自动识别文档中的标题层级（H1-H6）
  - 根据标题层级构建思维导图结构
  - 根节点为文档标题
  - 子节点为文档内各级标题
- **特性**：
  - 智能清理 Markdown 格式语法
  - 自动截断过长标题（超过 80 字符）
  - 空文档友好提示

#### 🔖 插入文档思维导图块
- **功能**：在文档中插入嵌入式思维导图块
- **快捷键**：`Alt+E`
- **使用场景**：
  - 在文档中直接展示思维导图
  - 支持实时渲染
  - 与文档内容无缝集成

### 🔗 文档关联线功能

- **自动显示文档引用关系**：关联线由出链文档指向入链文档
- **智能检测**：
  - 基于 simple-mind-map 的 AssociativeLine 插件
  - 使用优化的 SQL 查询获取文档间引用关系
  - 查询文档内所有块的出链，而不只是文档块本身
  - 自动去重，避免重复的关联线
- **用户控制**：
  - 工具栏添加"关联线"复选框，可随时显示/隐藏
  - 配置项可设置默认是否显示关联线
- **只读模式**：关联线不可编辑，专注于展示关系

### 📦 强大的导出功能

#### 支持的导出格式
- **JSON** - 结构化数据格式
- **PNG** - 高清图片格式
- **SVG** - 矢量图格式
- **PDF** - 文档格式
- **Markdown** - 标记语言格式
- **XMind** - 专业思维导图软件格式
- **TXT** - 纯文本格式

#### 导出选项
- **去除 HTML 样式**（适用于 JSON、TXT）
  - 可选择去除节点中的 HTML 标签和样式
  - 只保留纯文本内容
  
- **图片保存方式**（适用于 Markdown、JSON、TXT）
  1. **思源相对路径**（默认）- 保持原有的思源笔记相对路径
  2. **图片绝对路径** - 转换为文件系统的绝对路径
  3. **复制图片资源（ZIP 打包）** - 使用 JSZip 自动打包所有文件和图片
     - 一次下载获得完整的 ZIP 文件包
     - 文件结构自动组织：主文件 + images 文件夹
     - 解压即用，无需手动整理
     - 显示实时打包进度

### 🎨 主题与界面

- **自适应主题**：自动适配思源笔记的亮色/暗色主题
- **响应式布局**：支持桌面端和移动端
- **直观操作**：
  - 鼠标滚轮缩放
  - 左键拖动画布
  - 点击节点展开/折叠
  - 节点自由拖拽（部分支持）

### ⚙️ 配置选项

- **默认展开层级**：
  - 0 = 全部展开
  - ≥1 = 展开指定层数
  - 默认值：3
- **关联线显示**：可设置默认是否显示文档关联线

### 🛠️ 技术栈

- **思维导图引擎**：[Simple-Mind-Map](https://github.com/wanglin2/mind-map) - 轻量级且功能强大
- **插件框架**：思源笔记插件 API
- **打包工具**：JSZip - 用于导出时打包资源
- **开发工具**：TypeScript + Vite + SCSS

### 📝 使用方式

#### 方式一：快捷键（推荐）
- `Alt+Q` - 打开文档树思维导图
- `Alt+W` - 打开文档思维导图
- `Alt+E` - 插入文档思维导图块

#### 方式二：顶部工具栏
点击顶部工具栏对应的思维导图图标

#### 方式三：命令面板
在命令面板中搜索相应的思维导图命令并执行

### 🎯 注意事项

- 文档树思维导图只显示已打开的笔记本
- 文档标题超过 50 字符会自动截断
- 关联线功能需要文档间存在引用关系才会显示
- 导出大量图片时请耐心等待打包完成

### 🔮 未来计划

- 增强节点拖拽编辑功能
- 右键菜单提供更多文档操作选项
- 思维导图内搜索和过滤功能
- 更多自定义主题配色选项
- 性能优化，支持更大规模的文档树

### 📄 开源协议

MIT License

### 🤝 致谢

感谢思源笔记团队提供的优秀插件 API，以及 Simple-Mind-Map 项目提供的强大思维导图库。

### 📮 反馈与贡献

- **项目地址**：[GitHub Repository](https://github.com/ebAobS/mymind)
- **问题反馈**：[GitHub Issues](https://github.com/ebAobS/mymind/issues)
- **联系方式**：微信 ebAobS

---

**发布日期**：2025-10-06  
**版本号**：v1.0.0  
**作者**：ebAobS
